---
title: "HPO"
author: "<h4>Author: <i>Brian M. Schilder</i></h4>" 
date: "<h4>Most recent update: <i>`r format( Sys.Date(), '%b-%d-%Y')`</i></h4>"
output:
  rmarkdown::html_vignette
vignette: >
    %\VignetteIndexEntry{HPO} 
    %\usepackage[utf8]{inputenc}
    %\VignetteEngine{knitr::rmarkdown}
---

```{r setup, include=TRUE, message=FALSE} 
library(phenomix)
```

Analyze gene associations for 9k+ traits in the Human Phenotype Ontology (HPO). 

# Import data

```{r}
obj <- phenomix::get_HPO() 
```

# Plot UMAP

```{r}
gg_umap <- phenomix::plot_reduction(obj = obj, 
                                    keys = "umap", 
                                    color_var = "group_depth2")
```


# TF-IDF

```{r}
tfidf_hpo <- scNLP::plot_tfidf(obj = obj, 
                               terms_per_cluster = 2,
                               size_var = "n_genes",
                               color_var = "group_depth2",
                               point_palette = unname(c(pals::alphabet(),
                                                        pals::alphabet2(),
                                                        pals::glasbey())),
                               label_var = "description")
# ggplot2::ggsave(filename = file.path("/Desktop/phenome_decomposition",
#                                      "processed_data/HPO/HPO_UMAP_scNLP.png"),
#                 plot = tfidf_hpo$plot,
#                 height = 7,
#                 width = 10) 
```


# MOFA2

```{r, eval=FALSE}
#### Run ####
model_obj <- phenomix::run_mofa2(obj = obj, 
                                 assay = "RNA")
obj <- model_obj$obj
#### Plot ####
gg_mofa2 <- phenomix::plot_reduction(obj = obj, 
                                     reduction = "mofa2")
gg_mofa2umap <- phenomix::plot_reduction(obj = obj, 
                                         reduction = "mofa2umap")
```


# Session Info 

<details> 

```{r Session Info}
utils::sessionInfo()
```

</details>  
